SNR =     [0.1       0.2      0.4      0.8       1         2       3         4          5];


BER_MF1 = [ [ 0.463400  0.423150 0.347100 0.210350  0.155500 0.023150 0.001700  0.000050 0.000000]
            [ 0.464700  0.427600 0.348200 0.236300  0.203550 0.115850 0.064750  0.033500 0.015700]
            [ 0.470600  0.460550 0.493250 0.500750  0.498750 0.498150 0.496500  0.499900 0.506850] ]
BER_DD1 = [ [ 0.471700  0.443900 0.389600 0.272250  0.232300 0.071350 0.013700  0.001200 0.000350]
            [ 0.475800  0.448400 0.384250 0.278850  0.229500 0.069200 0.014450  0.001700 0.000100]
            [ 0.465750  0.445950 0.385050 0.280450  0.237200 0.069450 0.013850  0.001450 0.000050] ]
BER_LS1 = [ [ 0.464600  0.426050 0.353850 0.219350  0.169750 0.029500 0.003100  0.000100 0.000000]
            [ 0.467100  0.432400 0.357150 0.247550  0.210450 0.105950 0.040650  0.010550 0.002200]
            [ 0.471150  0.454550 0.439700 0.364600  0.320950 0.157000 0.061500  0.019150 0.004000] ]
BER_MLS1 =[ [0.483750  0.461200 0.429750 0.344850  0.317500 0.194600 0.136300  0.102550 0.083850]
            [0.480450  0.466500 0.420850 0.362150  0.335200 0.261800 0.185200  0.126850 0.076400]
            [0.478950  0.470650 0.441300 0.363100  0.319550 0.160350 0.064800  0.019300 0.004000] ]
        
BER_MF3 =[  [0.459050  0.423867 0.345367 0.209017  0.160683 0.022750 0.001400  0.000050 0.000000]
            [0.459850  0.420950 0.348300 0.236783  0.203767 0.114700 0.066100  0.035383 0.016350]
            [0.467567  0.462767 0.489633 0.500567  0.498017 0.501300 0.502467  0.496417 0.499433] ]
BER_DD3 =[  [0.469967  0.443317 0.385050 0.277800  0.233050 0.071500 0.014033  0.001800 0.000217]
            [0.470300  0.440683 0.383950 0.278800  0.232167 0.070567 0.013433  0.001700 0.000100]
            [0.474083  0.443267 0.385033 0.275450  0.231500 0.070300 0.013783  0.001833 0.000067] ]
BER_LS3 =[  [0.460467  0.425917 0.348983 0.216967  0.166983 0.026083 0.001817  0.000167 0.000000]
            [0.462650  0.422500 0.352717 0.242800  0.207250 0.103433 0.045517  0.015750 0.004450]
            [0.469400  0.458733 0.447450 0.399050  0.363883 0.221067 0.114783  0.054433 0.025200] ]
BER_MLS3 =[ [0.487000  0.472533 0.441350 0.384767  0.359333 0.253767 0.185600  0.146067 0.123217]
            [0.485017  0.468250 0.441833 0.393483  0.376700 0.304133 0.240983  0.179867 0.126833]
            [0.485950  0.480450 0.455617 0.391083  0.353133 0.193433 0.096283  0.045833 0.020467] ]
        
BER_MF4 =[  [0.461575  0.422775 0.342900 0.211875  0.159525 0.023200 0.001700  0.000025 0.000000]
            [0.460025  0.422600 0.349925 0.241775  0.202975 0.116300 0.068450  0.035400 0.017075]
            [0.473800  0.463075 0.491350 0.501425  0.498625 0.496625 0.504600  0.499400 0.499500] ]
BER_DD4 =[  [0.473275  0.443425 0.386125 0.280800  0.231150 0.070375 0.015075  0.001725 0.000200]
            [0.468225  0.442325 0.383250 0.277200  0.232175 0.069575 0.013800  0.001475 0.000100]
            [0.473450  0.447625 0.379950 0.279100  0.229525 0.072400 0.013700  0.001675 0.000100] ]
BER_LS4 =[  [0.459000  0.427150 0.347575 0.218875  0.167325 0.026275 0.002300  0.000050 0.000000]
            [0.460200  0.425200 0.354125 0.245350  0.206000 0.105950 0.048950  0.017550 0.005975]
            [0.471600  0.457375 0.450900 0.406500  0.378000 0.252475 0.155025  0.087125 0.044425] ]
BER_MLS4=[  [0.484450  0.475525 0.445200 0.396250  0.374375 0.271775 0.209100  0.163975 0.136350]
            [0.485525  0.475350 0.450825 0.403525  0.392000 0.316450 0.257025  0.201675 0.156600]
            [0.488225  0.479000 0.464300 0.408250  0.371975 0.223400 0.127100  0.066800 0.032950] ]
        
BER_MF5 =[  [0.461960  0.418180 0.346000 0.216480  0.159540 0.022820 0.001720  0.000080 0.000000]
            [0.460700  0.421260 0.349740 0.237340  0.204040 0.116560 0.066360  0.035980 0.016360]
            [0.463800  0.459100 0.491940 0.497340  0.497840 0.502360 0.498760  0.500660 0.501700] ]
BER_DD5 =[  [0.470480  0.438760 0.388840 0.281940  0.232000 0.070080 0.013960  0.001580 0.000140]
            [0.470080  0.441740 0.384080 0.278120  0.229840 0.071060 0.013480  0.001840 0.000140]
            [0.464660  0.437520 0.382260 0.281020  0.231200 0.072420 0.013080  0.001540 0.000140] ]
BER_LS5 =[  [0.464280  0.422220 0.349320 0.223200  0.166260 0.025860 0.002220  0.000140 0.000000]
            [0.462280  0.424140 0.354780 0.243120  0.207160 0.107560 0.047680  0.018860 0.006940]
            [0.465560  0.452720 0.453060 0.411680  0.384700 0.282900 0.187380  0.123280 0.074820] ]
BER_MLS5=[  [0.488560  0.477260 0.452440 0.401260  0.382600 0.286360 0.222140  0.175980 0.147700]
            [0.487160  0.473540 0.453240 0.412880  0.393640 0.331780 0.275620  0.221220 0.177640]
            [0.488360  0.482020 0.464820 0.419200  0.393780 0.254140 0.150600  0.090960 0.052040] ]
        
        
BER_MF7 =[  [0.457886  0.419786 0.344043 0.211714  0.158457 0.024171 0.001786  0.000029 0.000000]
            [0.458414  0.417743 0.349571 0.237286  0.202729 0.113600 0.066129  0.035329 0.016600]
            [0.465243  0.458414 0.490114 0.500029  0.496429 0.498329 0.498486  0.498757 0.499286] ]
BER_DD7 =[  [0.471829  0.441057 0.383071 0.276229  0.230857 0.072157 0.014157  0.001757 0.000057]
            [0.471871  0.439529 0.381357 0.276171  0.231071 0.072343 0.013971  0.001429 0.000143]
            [0.473300  0.439786 0.380986 0.278614  0.232771 0.069943 0.014000  0.001729 0.000143] ]
BER_LS7 =[  [0.458829  0.423357 0.348129 0.218729  0.165086 0.027743 0.002229  0.000057 0.000000]
            [0.459614  0.421057 0.351957 0.243100  0.206386 0.105371 0.049643  0.021014 0.008271]
            [0.465986  0.452986 0.452857 0.419200  0.394514 0.307700 0.239286  0.180243 0.133229] ]
BER_MLS7 =[ [0.489600  0.479714 0.455171 0.416386  0.395786 0.305786 0.245271  0.197471 0.170514]
            [0.487629  0.476900 0.458943 0.424343  0.410557 0.351014 0.298757  0.250429 0.210957]
            [0.489300  0.482886 0.469671 0.436614  0.412829 0.309000 0.212314  0.145486 0.098800] ]

BER_MF9 =[  [0.462656  0.422922 0.344922 0.213967  0.158933 0.023489 0.001833  0.000044 0.000000]
            [0.460944  0.423233 0.348722 0.239378  0.200644 0.116044 0.066489  0.033589 0.017111]
            [0.467456  0.464400 0.490489 0.499044  0.498667 0.501189 0.500556  0.499611 0.497244] ]
BER_DD9 =[  [0.471278  0.441111 0.383444 0.277844  0.231378 0.071522 0.013989  0.001311 0.000100]
            [0.470133  0.439989 0.386478 0.280444  0.228722 0.073789 0.014356  0.001478 0.000133]
            [0.473256  0.441289 0.386022 0.277178  0.231467 0.069611 0.013800  0.001767 0.000100] ]
BER_LS9 =[  [0.461467  0.422067 0.348989 0.219067  0.164689 0.026811 0.002056  0.000022 0.000000]
            [0.461700  0.424944 0.353289 0.243689  0.204844 0.107044 0.050978  0.020778 0.009089]
            [0.467456  0.457911 0.454744 0.420100  0.402178 0.323633 0.264778  0.215133 0.176100] ]
BER_MLS9 =[ [0.490144  0.480467 0.462400 0.426167  0.407189 0.326078 0.261789  0.214544 0.183778]
            [0.490033  0.485133 0.464322 0.433367  0.415989 0.365511 0.317556  0.274689 0.232956]
            [0.490711  0.486578 0.474278 0.443489  0.427622 0.344778 0.264722  0.201333 0.158867] ]

n=6
BER_LS = [BER_LS1(:,n) BER_LS3(:,n) BER_LS3(:,n) BER_LS4(:,n) BER_LS5(:,n) BER_LS7(:,n) BER_LS9(:,n) ]
BER_MLS = [BER_MLS1(:,n) BER_MLS3(:,n) BER_MLS3(:,n) BER_MLS4(:,n) BER_MLS5(:,n) BER_MLS7(:,n) BER_MLS9(:,n) ]
BER_DD = [BER_DD1(:,n) BER_DD3(:,n) BER_DD3(:,n) BER_DD4(:,n) BER_DD5(:,n) BER_DD7(:,n) BER_DD9(:,n) ]
WinSize= [1 2 3 4 5 7 9]        
        
figure(11)
semilogy(WinSize, BER_DD(1,:),'-x',WinSize, BER_DD(2,:),'-+',WinSize, BER_DD(3,:),'-*',WinSize, BER_LS(1,:),'-<',WinSize, BER_LS(2,:),'-s',WinSize, BER_LS(3,:),'->',WinSize, BER_MLS(1,:),'-^',WinSize, BER_MLS(2,:),'-o',WinSize, BER_MLS(3,:),'-v')
ylim([0.02 0.5])
grid;
xlabel('Truncated Window Size P')
ylabel('BER')
legend('DD A_2/A_1=0.1','DD A_2/A_1=1.0','DD A_2/A_1=10','LS A_2/A_1=0.1','LS A_2/A_1=1.0','LS A_2/A_1=10','MLS A_2/A_1=0.1','MLS A_2/A_1=1.0','MLS A_2/A_1=10');        


A21 = [0.1; 0.2; 0.4; 0.6; 0.8; 1; 1.5; 2; 2.5; 3; 3.5; 4; 5];
A21log = log10(A21).*20;
NFR_MF =[ 0.024425  0.027425 0.036750 0.054075  0.079700 0.114025 0.226600  0.344000 0.432050 0.476875  0.495800 0.495900 0.501950]
NFR_DD =[ 0.070950  0.071525 0.071875 0.070300  0.068725 0.071375 0.070000  0.072725 0.070925 0.069900  0.070175 0.071275 0.072200]
NFR_LS1=[ 0.029400  0.031900 0.042800 0.062150  0.081750 0.099800 0.147200  0.176700 0.183250 0.186600  0.174200 0.176350 0.165250]
NFR_MLS1=[0.199800  0.196950 0.208650 0.226050  0.248250 0.257600 0.258300  0.251600 0.225850 0.216200  0.197300 0.186450 0.175000]  
NFR_LS4=[ 0.028275  0.030900 0.040400 0.057625  0.079625 0.104325 0.166150  0.210425 0.239800 0.252975  0.261500 0.258600 0.261775]  
NFR_MLS4=[0.271200  0.275200 0.285325 0.305950  0.314050 0.319225 0.324300  0.318725 0.315025 0.305550  0.289575 0.279675 0.269950]

figure(12)
semilogy(A21log, NFR_MF(1,:),'-+', A21log, NFR_DD(1,:),'-o', A21log, NFR_LS1(1,:),'-^', A21log, NFR_MLS1(1,:),'-v', A21log, NFR_LS4(1,:),'-<', A21log, NFR_MLS4(1,:),'->')
grid;
title('Near-Far-Resistance');
xlabel('NFR A_2/A_1(dB)');
ylabel('Bit-Error-Rate (BER)');
legend('MF ','DD','LS with P=1','MLS with P=1','LS with P=4','MLS with P=4');
