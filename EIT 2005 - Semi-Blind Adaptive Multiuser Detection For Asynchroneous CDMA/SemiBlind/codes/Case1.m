A21 = [0.1; 1; 10];

SNR =     [0.1       0.2      0.4      0.8       1         2       3         4          5];


BER_MF1 =[ [0.456350  0.422100 0.348950 0.217550  0.156100 0.024850 0.001600  0.000000 0.000000]
        [ 0.463400  0.421050 0.346650 0.240700  0.201350 0.112500 0.062600  0.034600 0.015700]
        [ 0.469000  0.453600 0.492900 0.500750  0.498750 0.498150 0.496500  0.499900 0.506850] ]
    
BER_DD1 =[ [0.474300  0.440900 0.387750 0.279050  0.230050 0.070200 0.014200  0.001150 0.000200]
        [ 0.468050  0.442050 0.377500 0.278450  0.225350 0.073100 0.012800  0.001850 0.000150]
        [ 0.464200  0.435950 0.389550 0.280850  0.233650 0.071550 0.013400  0.001300 0.000150] ]
    
BER_LS1 =[ [0.474300  0.440900 0.387750 0.279050  0.230050 0.070200 0.014200  0.001150 0.000200]
        [ 0.468050  0.442050 0.377500 0.278450  0.225350 0.073100 0.012800  0.001850 0.000150]
        [ 0.464200  0.435950 0.389550 0.280850  0.233650 0.071550 0.013400  0.001300 0.000150] ]

SNRlog = log10(SNR).*20;
figure(109)
semilogy(SNRlog, BER_MF1(1,:),'-*',SNRlog, BER_MF1(2,:),'-+',SNRlog, BER_MF1(3,:),'-x', SNRlog, BER_DD1(2,:),'-o', SNRlog, BER_LS1(1,:),'-d', SNRlog, BER_LS1(2,:),'-p', SNRlog, BER_LS1(3,:),'-h')
ylim([1.0/20000 0.55])
xlim([min(SNRlog) max(SNRlog)])
grid;
title('BER of Different Multiuser Detection Algorithms');
xlabel('SNR (dB)');
ylabel('Bit-Error-Rate (BER)');
legend('MF with A_2/A_1=0.1','MF with A_2/A_1=1','MF with A_2/A_1=10','Decorrelating Detector','LS with A_2/A_1=0.1','LS with A_2/A_1=1','LS with A_2/A_1=10');
    
    
BER_MF2 =[ [ 0.463300  0.420750 0.345025 0.213525  0.157225 0.023350 0.002000  0.000000 0.000000]
        [ 0.459825  0.420400 0.347575 0.238000  0.205625 0.114350 0.065850  0.035250 0.016800]
        [ 0.466675  0.461550 0.491750 0.500375  0.499000 0.495800 0.502700  0.501925 0.494350] ]
BER_DD2 =[ [ 0.474325  0.442700 0.384900 0.281025  0.228125 0.069275 0.013950  0.001575 0.000175]
        [ 0.469725  0.440300 0.383325 0.277500  0.233850 0.071300 0.013300  0.001275 0.000175]
        [ 0.470325  0.441300 0.385150 0.283500  0.227650 0.070825 0.013300  0.001700 0.000075] ]
BER_LS2 =[ [0.474825  0.439900 0.381725 0.276350  0.221800 0.063300 0.012425  0.001175 0.000100]
        [ 0.471125  0.438225 0.382000 0.270675  0.227000 0.064900 0.011100  0.001100 0.000150]
        [ 0.467275  0.439850 0.380150 0.277000  0.222050 0.065925 0.011200  0.001175 0.000050] ]
    
BER_MF3 =[ [0.462283  0.417550 0.341783 0.212550  0.156183 0.024117 0.001417  0.000017 0.000000]
        [ 0.458300  0.421867 0.351333 0.239950  0.202533 0.111433 0.065867  0.034883 0.016383]
        [ 0.469933  0.464300 0.495450 0.499300  0.499217 0.502767 0.501117  0.499433 0.502017] ]
BER_DD3 =[ [0.472183  0.438400 0.380717 0.279133  0.231733 0.070367 0.012700  0.001450 0.000133]
        [ 0.470200  0.440933 0.387500 0.278033  0.230167 0.071900 0.013050  0.001783 0.000083]
        [ 0.474933  0.443317 0.385733 0.279800  0.232000 0.071833 0.014000  0.001933 0.000117] ]
BER_LS3 =[ [0.473133  0.435783 0.379067 0.272767  0.222583 0.062600 0.010500  0.001250 0.000067]
        [0.469283  0.437517 0.383100 0.268817  0.222733 0.063433 0.010750  0.001367 0.000050]
        [ 0.474517  0.439500 0.381217 0.270367  0.223300 0.063917 0.011267  0.001267 0.000083] ]

BER_MF4 =[ [0.459975  0.420225 0.344700 0.211400  0.157875 0.023325 0.001600  0.000050 0.000000]
        [ 0.455350  0.423125 0.345300 0.241400  0.203225 0.115825 0.067150  0.035250 0.016750]
        [ 0.468500  0.462150 0.492050 0.496975  0.500325 0.496400 0.501650  0.501125 0.500175] ]
BER_DD4 =[ [ 0.468025  0.438600 0.386275 0.278350  0.231475 0.070850 0.013225  0.001425 0.000150]
        [ 0.469375  0.443550 0.382300 0.279125  0.232200 0.070825 0.013250  0.001300 0.000100]
        [ 0.472275  0.441400 0.385200 0.279475  0.227925 0.072350 0.014400  0.001425 0.000100] ]
BER_LS4 =[ [ 0.466950  0.435625 0.379100 0.273275  0.220550 0.061425 0.010525  0.000875 0.000050]
        [ 0.466800  0.439250 0.379325 0.270125  0.221275 0.062900 0.010500  0.000825 0.000125]
        [ 0.470075  0.438275 0.378125 0.269800  0.221050 0.063725 0.010750  0.000925 0.000025] ]

% SNRlog = log10(SNR).*20;
figure(110)
semilogy(SNRlog, BER_MF4(1,:),'-*',SNRlog, BER_MF4(2,:),'-+',SNRlog, BER_MF4(3,:),'-x', SNRlog, BER_DD4(2,:),'-o', SNRlog, BER_LS4(1,:),'-d', SNRlog, BER_LS4(2,:),'-p', SNRlog, BER_LS4(3,:),'-h')
ylim([1.0/10000 0.55])
xlim([min(SNRlog) max(SNRlog)])
grid;
title('BER of Different Multiuser Detection Algorithms');
xlabel('SNR (dB)');
ylabel('Bit-Error-Rate (BER)');
legend('MF with A_2/A_1=0.1','MF with A_2/A_1=1','MF with A_2/A_1=10','Decorrelating Detector','LS with A_2/A_1=0.1','LS with A_2/A_1=1','LS with A_2/A_1=10');
    
  
BER_MF5 =[ [0.464840  0.420160 0.343900 0.211600  0.155760 0.023240 0.001900  0.000060 0.000000]
        [ 0.460100  0.423680 0.350200 0.238260  0.204720 0.111720 0.064180  0.034680 0.016380]
        [ 0.468640  0.465500 0.491400 0.499180  0.495200 0.500600 0.500280  0.499920 0.500720] ]

BER_DD5 =[ [0.476520  0.440780 0.383100 0.278220  0.228260 0.072740 0.013380  0.001760 0.000140]
        [ 0.475780  0.442000 0.384500 0.276540  0.232060 0.070280 0.014040  0.001860 0.000160]
        [ 0.467320  0.442780 0.383880 0.277220  0.231460 0.069600 0.013880  0.001580 0.000120] ]

BER_LS5 =[ [0.474760  0.437000 0.380360 0.268320  0.217720 0.063280 0.010360  0.001060 0.000100]
        [ 0.473500  0.440120 0.380000 0.268420  0.219180 0.061780 0.010480  0.001220 0.000080]
        [ 0.467700  0.440560 0.377840 0.266060  0.221180 0.060580 0.010380  0.001060 0.000080] ]


BER_MF7 =[ [0.461800  0.417400 0.343643 0.211171  0.155629 0.024671 0.001557  0.000043 0.000000]
        [ 0.461500  0.418814 0.348386 0.240171  0.201600 0.113971 0.064971  0.034586 0.016200]
        [ 0.464271  0.463057 0.490500 0.499314  0.497514 0.498586 0.498743  0.499957 0.499729] ]

BER_DD7 =[ [0.471814  0.438871 0.387543 0.278771  0.230343 0.072100 0.012957  0.001629 0.000143]
        [ 0.469271  0.438643 0.381957 0.277886  0.231000 0.071014 0.013314  0.001457 0.000143]
        [ 0.467100  0.442114 0.382571 0.279900  0.231929 0.069414 0.014543  0.001657 0.000129] ]

BER_LS7 =[ [0.470100  0.437586 0.379457 0.269100  0.216586 0.062700 0.010200  0.001071 0.000071]
        [ 0.468957  0.436486 0.375943 0.268129  0.219014 0.062829 0.010271  0.000971 0.000086]
        [ 0.468957  0.441171 0.377986 0.270343  0.218600 0.059914 0.010557  0.001314 0.000071] ]


BER_MF9 =[ [0.461311  0.417722 0.342589 0.212156  0.158900 0.024089 0.001489  0.000067 0.000000]
        [ 0.459822  0.421767 0.349933 0.239800  0.203878 0.113500 0.065911  0.034556 0.016267]
        [ 0.470344  0.464267 0.490600 0.499067  0.498667 0.501189 0.500556  0.499611 0.497244] ]

BER_DD9 =[ [0.471811  0.439367 0.382389 0.280822  0.228967 0.071811 0.014356  0.001767 0.000167]
        [ 0.471311  0.438456 0.384744 0.278033  0.232833 0.070344 0.014289  0.001678 0.000078]
        [ 0.473400  0.442667 0.381589 0.280733  0.230322 0.070089 0.013667  0.001556 0.000056] ]

BER_LS9 =[ [0.469656  0.437978 0.376567 0.272022  0.218144 0.061911 0.010633  0.001011 0.000033]
        [ 0.470578  0.437467 0.379178 0.268100  0.222033 0.061233 0.010422  0.001078 0.000022]
        [ 0.472200  0.439478 0.377467 0.268989  0.218967 0.060422 0.010289  0.000933 0.000044] ]

    
BER_LS = [BER_LS1(:,6) BER_LS2(:,6) BER_LS3(:,6) BER_LS4(:,6) BER_LS5(:,6) BER_LS7(:,6) BER_LS9(:,6) ]
BER_DD = [BER_DD1(:,6) BER_DD2(:,6) BER_DD3(:,6) BER_DD4(:,6) BER_DD5(:,6) BER_DD7(:,6) BER_DD9(:,6) ]
WinSize= [1 2 3 4 5 7 9]

figure(111)
semilogy(WinSize, BER_DD(1,:),'-^',WinSize, BER_DD(2,:),'-o',WinSize, BER_DD(3,:),'-v',WinSize, BER_LS(1,:),'-<',WinSize, BER_LS(2,:),'-s',WinSize, BER_LS(3,:),'->')
ylim([10^(-1.3) 10^(-1.0)])
grid;
xlabel('Truncated Window Size P')
ylabel('BER')
legend('DD A_2/A_1=0.1','DD A_2/A_1=1.0','DD A_2/A_1=10','LS A_2/A_1=0.1','LS A_2/A_1=1.0','LS A_2/A_1=10');



A21 = [0.1; 0.2; 0.4; 0.6; 0.8; 1; 1.5; 2; 2.5; 3; 3.5; 4; 5];
A21log = log10(A21).*20;
NFR_MF =[ 0.021825  0.026950 0.036700 0.052550  0.082575 0.116250 0.226625  0.345375 0.433825 0.475575  0.496200 0.495800 0.501900]
NFR_DD =[ 0.068000  0.069875 0.070250 0.069600  0.071425 0.068550 0.071700  0.069925 0.071825 0.071950  0.069025 0.072150 0.071075]
NFR_LS1=[ 0.068050  0.070000 0.070300 0.070950  0.069000 0.072100 0.068350  0.069300 0.070350 0.075600  0.073000 0.070300 0.069000]
NFR_LS4=[ 0.059925  0.061975 0.062800 0.061650  0.063650 0.061875 0.063550  0.061950 0.062625 0.063300  0.061275 0.063875 0.063075]

figure(112)
semilogy(A21log, NFR_MF(1,:),'-+', A21log, NFR_DD(1,:),'-o', A21log, NFR_LS1(1,:),'-<', A21log, NFR_LS4(1,:),'->')
grid;
title('Near-Far-Resistance');
xlabel('NFR A_2/A_1(dB)');
ylabel('Bit-Error-Rate (BER)');
legend('MF ','DD','LS with P=1','LS with P=4');



%%----------------------------------------------------------------------------------------------------%%
d_mean_LS1 =[ [272.981027  136.288120  67.616164 34.222304  27.189317  13.668597 9.011594  6.743625  5.467045]
            [29.710157  14.893600  7.471242 3.756732  2.963252  1.474187 0.997471  0.749918  0.597707]
            [11.400904  5.697525  2.870211 1.429001  1.137354  0.568780 0.377081  0.285318  0.229684 ] ]
d_std_LS1 = [ [171.238321  84.857068  42.747856 21.459391  16.955158  8.646409 5.588566  4.213123  3.432219]
            [18.236044  9.063924  4.458123 2.286863  1.800177  0.885289 0.604446  0.456342  0.364403]
            [8.145387  4.063506  2.048230 1.013735  0.819801  0.407325 0.268093  0.204385  0.164054] ]

d_mean_LS3 =[ [472.003570  237.532046  118.313161 59.703739  47.211665  23.726412 15.834615  11.781276  9.474599]
            [ 52.581571  26.169879  12.996510 6.552589  5.228507  2.622540 1.756451  1.308843  1.042464]
            [ 21.616045  10.788159  5.406452 2.691706  2.164670  1.077455 0.719130  0.540044  0.430331] ]
d_std_LS3 = [ [282.456344  142.619470  70.025555 35.983601  28.411082  14.144393 9.452584  7.044185  5.683153]
            [ 28.743505  14.108586  7.020311 3.561078  2.847495  1.419285 0.966350  0.714698  0.556872]
            [ 9.031340  4.545915  2.257255 1.124343  0.905042  0.455185 0.300572  0.227028  0.180047 ] ]
        
        
d_mean_LS5 =[ [778.981290  387.362948  193.631754 96.560830  77.265632  38.868064 25.781385  19.216844  15.564602]
            [83.280466  41.232723  20.629353 10.435275  8.354138  4.151825 2.786361  2.097729  1.659218]
            [29.168424  14.540554  7.245079 3.599161  2.887181  1.449123 0.962559  0.723934  0.580402] ]
        
d_std_LS5 = [ [495.937460  242.357688  119.587903 61.661673  48.495494  24.432080 16.313006  12.178247  9.950047]
            [48.411094  23.774310  11.807418 6.128428  4.875378  2.383703 1.613401  1.226518  0.959189]
            [9.665264  4.801125  2.379690 1.185963  0.944776  0.480418 0.316811  0.238430  0.190568]]
        
        
d_mean_LS7 = [ [1228.618815  622.511972  305.855680 152.914983  123.322275  61.420034 41.512426  30.516564  24.420087]
            [127.298383  64.181608  31.790434 16.202225  12.823606  6.376161 4.285518  3.218992  2.542579]
            [ 35.943123  18.030810  8.999821 4.510619  3.575160  1.792533 1.194488  0.897777  0.716583] ]

d_std_LS7 = [ [893.072973  470.745476  227.391200 110.507310  90.885547  44.115369 30.840020  22.452447  17.786968]
            [ 87.478142  45.067036  22.202547 11.504548  9.017814  4.457909 2.992669  2.244445  1.773534 ]
            [ 10.905739  5.518453  2.736332 1.358083  1.051163  0.535612 0.357464  0.265503  0.215690] ]
        
d_mean_LS9 =[ [1925.709393  966.592507  486.722531 241.157347  190.950439  96.570604 63.212359  47.903347  38.331482]
            [195.525533  99.424808  49.238694 24.450719  19.836764  9.810354 6.636585  4.917671  3.938313]
            [44.111633  22.116100  11.038346 5.480839  4.390224  2.193456 1.459624  1.107905  0.881650] ]
d_std_LS9 =[ [1845.290101  883.497304  436.032598 223.068150  175.161804  92.553507 57.251614  44.253848  36.386107]
            [167.805768  89.120410  44.652700 21.388255  18.280775  8.531575 5.854033  4.290628  3.449394]
            [15.598342  7.801573  3.951406 1.959552  1.636148  0.808649 0.512548  0.415460  0.327468] ]
figure(113)
plot(SNR, d_std_LS1(2,:)./d_mean_LS1(2,:),SNR, d_std_LS3(2,:)./d_mean_LS3(2,:),SNR, d_std_LS5(2,:)./d_mean_LS5(2,:),SNR, d_std_LS7(2,:)./d_mean_LS7(2,:),SNR, d_std_LS1(3,:)./d_mean_LS1(3,:),SNR, d_std_LS3(3,:)./d_mean_LS3(3,:),SNR, d_std_LS5(3,:)./d_mean_LS5(3,:),SNR, d_std_LS7(3,:)./d_mean_LS7(3,:))
legend('P=1,A_2/A_1=1.0','P=3,A_2/A_1=1.0','P=5,A_2/A_1=1.0','P=7,A_2/A_1=1.0','P=1,A_2/A_1=10','P=3,A_2/A_1=10','P=5,A_2/A_1=10','P=7,A_2/A_1=10');